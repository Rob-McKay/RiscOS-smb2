/*
 * Created by cmhg vsn 5.46 [28 Nov 2020]
 */

#ifndef __cmhg_smb2Hdr_h
#define __cmhg_smb2Hdr_h

#ifndef __kernel_h
#include "kernel.h"
#endif

#define CMHG_VERSION 546

#define Module_Title                     "libsmb2"
#define Module_Help                      "libsmb2"
#define Module_VersionString             "0.01"
#define Module_VersionNumber             1
#ifndef Module_Date
#define Module_Date                      "25 May 2023"
#endif


/*
 * SWI handler code
 * ================
 *
 * swi_offset contains the offset of the SWI into your SWI chunk.
 * r points to the registers passed to the SWI.
 *
 * Return NULL if the SWI is handled successfully; otherwise return
 * a pointer to an error block which describes the error.
 * The veneer code sets the 'V' bit if the returned value is non-NULL.
 * The special value error_BAD_SWI may be returned if you do not
 * implement a SWI; the veneer will arrange for the appropriate
 * standard internationalised error 'SWI value out of range for
 * module libsmb2' to be returned.
 * The handler may update any of its input registers (R0-R9).
 * pw is the private word pointer ('R12') value passed into the
 * SWI handler entry veneer.
 */
#define SMB2_00                         0x05a500
#ifndef SMB2_CreateContext
#define SMB2_CreateContext              0x05a500
#define SMB2_DestroyContext             0x05a501
#define SMB2_SetSMBVersion              0x05a502
#define SMB2_SetSecurityMode            0x05a503
#define SMB2_SetSeal                    0x05a504
#define SMB2_SetSigning                 0x05a505
#define SMB2_SetUser                    0x05a506
#define SMB2_SetPassword                0x05a507
#define SMB2_SetDomain                  0x05a508
#define SMB2_SetWorkstation             0x05a509
#define SMB2_ConnectShare               0x05a50a
#define SMB2_DisconnectShare            0x05a50b
#define SMB2_ShareEnum                  0x05a50c
#define SMB2_OpenDir                    0x05a50d
#define SMB2_CloseDir                   0x05a50e
#define SMB2_ReadDir                    0x05a50f
#define SMB2_RewindDir                  0x05a510
#define SMB2_TellDir                    0x05a511
#define SMB2_SeekDir                    0x05a512
#define SMB2_Open                       0x05a513
#define SMB2_Close                      0x05a514
#define SMB2_FSync                      0x05a515
#define SMB2_GetMaxReadSize             0x05a516
#define SMB2_GetMaxWriteSize            0x05a517
#define SMB2_PRead                      0x05a518
#define SMB2_Read                       0x05a519
#define SMB2_PWrite                     0x05a51a
#define SMB2_Write                      0x05a51b
#endif

#define error_BAD_SWI ((_kernel_oserror *) -1)

_kernel_oserror *libsmb2_swi_handler(int swi_offset, _kernel_swi_regs *r, void *pw);

#endif
